#!/usr/bin/env node
import{Command as y}from"commander";import{log as r,text as h,isCancel as i,confirm as j,select as m,spinner as w}from"@clack/prompts";import*as v from"semver";import{dirname as x,join as p}from"path";import{fileURLToPath as $}from"url";import{readFileSync as l,existsSync as k,rmSync as S}from"fs";import{clone as N}from"@npmcli/git";function P(){const e="14.0.0",n=process.version;v.gte(n,e)||(r.error(`This CLI requires Node.js version ${e} or higher.`),r.error(`Current Node.js version: ${n}`),process.exit(1))}const u=x($(import.meta.url));function O(){try{const e=p(u,"..","package.json");return JSON.parse(l(e,"utf8")).version||"unknown"}catch{try{const e=p(u,"..","..","package.json");return JSON.parse(l(e,"utf8")).version||"unknown"}catch{return"unknown"}}}const V={"Ant-design-pro":"https://github.com/ant-design/ant-design-pro.git"},b={Nuxt:"https://git.haier.net/zjdz-3d-web/self/nuxt4-template.git","Ruoyi-Vue3":"https://gitcode.com/yangzongzhuan/RuoYi-Vue3.git"},d={Vue:b,React:V};function C(e){return/^[a-zA-Z0-9-_]+$/.test(e)}async function R(e){e||(e=await h({message:"Project name:",placeholder:"my-ssr-app",initialValue:"my-ssr-app",validate:t=>{const o=t.trim();if(!o)return"Project name is required!";if(!C(o))return"Project name can only contain alphanumeric characters, hyphens, and underscores."}}),i(e)&&(r.info("Operation cancelled."),process.exit(0)));const n=p(process.cwd(),e);if(k(n)){const t=await j({message:`${e} project already exists. Do you want to overwrite it?`,initialValue:!1});(i(t)||!t)&&(r.info("Operation cancelled."),process.exit(0)),S(n,{recursive:!0,force:!0})}const f=Object.keys(d).map(t=>({value:t,label:t})),a=await m({message:"Pick a framework type.",options:f});i(a)&&(r.info("Operation cancelled."),process.exit(0));const s=d?.[a];s||(r.error(`No templates found for framework: ${a}`),process.exit(1));const g=Object.entries(s).map(([t,o])=>({value:t,label:t,hint:o})),c=await m({message:"Pick a template.",options:g});i(c)&&(r.info("Operation cancelled."),process.exit(0)),r.step(`Creating new SSR project: ${e} with ${a} ${c} template (using ${s[c]})`);try{const t=s[c],o=w();o.start(`Cloning template from: ${t}`),await N(t,"",p(process.cwd(),e)),o.stop(`Successfully cloned template: ${t}`),r.success(`Successfully created project: ${e}`),r.message("Next steps:"),r.message(`  cd ${e}`),r.message("  npm install (or yarn install / pnpm install)"),r.message("  npm run dev")}catch(t){r.error(`Failed to create project: ${t.message}`),process.exit(1)}}async function z(){P();const e=new y;e.version(O()).name("syn").description("A CLI tool for creating Server-Side Rendering projects"),e.command("create").description("create a new project").argument("[project-name]","name of the project").action(async n=>{await R(n)}),await e.parseAsync()}z().catch(e=>{r.error(e.message),process.exit(1)});
//# sourceMappingURL=index.mjs.map
