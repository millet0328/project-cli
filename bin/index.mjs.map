{"version":3,"file":"index.mjs","sources":["../utils/version.mjs","../utils/package.mjs","../template/react.mjs","../template/vue.mjs","../template/index.mjs","../scripts/create.mjs","../scripts/index.mjs"],"sourcesContent":["import * as semver from 'semver';\nimport { log } from '@clack/prompts';\n\n// 检查 Node.js 版本\nexport function checkNodeVersion() {\n  const requiredVersion = '14.0.0';\n  const currentNodeVersion = process.version;\n\n  if (!semver.gte(currentNodeVersion, requiredVersion)) {\n    log.error(`This CLI requires Node.js version ${requiredVersion} or higher.`);\n    log.error(`Current Node.js version: ${currentNodeVersion}`);\n    process.exit(1);\n  }\n}","import { dirname, join } from 'path';\nimport { fileURLToPath } from 'url';\nimport { readFileSync } from 'fs';\n\nconst __dirname = dirname(fileURLToPath(import.meta.url));\n\n// 获取包版本\nexport function getPackageVersion() {\n  try {\n    const packageJsonPath = join(__dirname, '..', 'package.json');\n    const packageJson = JSON.parse(readFileSync(packageJsonPath, 'utf8'));\n    return packageJson.version || 'unknown';\n  } catch (e) {\n    // 如果上述路径失败，尝试另一个路径\n    try {\n      const packageJsonPath = join(__dirname, '..', '..', 'package.json');\n      const packageJson = JSON.parse(readFileSync(packageJsonPath, 'utf8'));\n      return packageJson.version || 'unknown';\n    } catch (e2) {\n      return 'unknown';\n    }\n  }\n}","export const reactTemplates = {\n    \"Ant-design-pro\": 'https://github.com/ant-design/ant-design-pro.git',\n};\n","export const vueTemplates = {\n  Nuxt: 'https://git.haier.net/zjdz-3d-web/self/nuxt4-template.git',\n  'Ruoyi-Vue3': 'https://gitcode.com/yangzongzhuan/RuoYi-Vue3.git'\n};","import { reactTemplates } from './react.mjs';\nimport { vueTemplates } from './vue.mjs';\n\nexport const templates = {\n  Vue: vueTemplates,\n  React: reactTemplates,\n};\n\nexport { reactTemplates } from './react.mjs';\nexport { vueTemplates } from './vue.mjs';\n","import {text, isCancel, log, confirm, select, spinner} from '@clack/prompts';\nimport {existsSync, rmSync} from 'fs';\nimport {join} from 'path';\n// 导入 git\nimport {clone} from '@npmcli/git';\n\n// 导入模板配置\nimport {templates} from '../template/index.mjs';\n\n// 检查项目名称是否有效\nexport function isValidProjectName(name) {\n    return /^[a-zA-Z0-9-_]+$/.test(name);\n}\n\n// 创建项目\nexport async function createProject(projectName) {\n    if (!projectName) {\n        projectName = await text({\n            message: 'Project name:',\n            placeholder: 'my-ssr-app',\n            initialValue: 'my-ssr-app',\n            validate: (value) => {\n                const trimmedValue = value.trim();\n\n                if (!trimmedValue) {\n                    return 'Project name is required!';\n                }\n\n                // 检查项目名称是否符合规范\n                if (!isValidProjectName(trimmedValue)) {\n                    return 'Project name can only contain alphanumeric characters, hyphens, and underscores.';\n                }\n\n            }\n        });\n        // isCancel 函数是一个守卫，用于检测用户何时使用 CTRL + C 取消问题。你应该为每个提示处理这种情况，可以选择使用 cancel 工具提供一个友好的取消消息。\n        if (isCancel(projectName)) {\n            log.info('Operation cancelled.');\n            process.exit(0);\n        }\n    }\n\n    // 检查同名文件夹是否存在\n    const projectPath = join(process.cwd(), projectName);\n    if (existsSync(projectPath)) {\n        const overwrite = await confirm({\n            message: `${projectName} project already exists. Do you want to overwrite it?`,\n            initialValue: false\n        });\n\n        if (isCancel(overwrite) || !overwrite) {\n            log.info('Operation cancelled.');\n            process.exit(0);\n        }\n\n        // 如果用户确认覆盖，则删除现有目录\n        rmSync(projectPath, {recursive: true, force: true});\n    }\n\n    // 选择项目类型 - 从模板配置中动态获取框架选项\n    const frameworkOptions = Object.keys(templates).map(key => {\n        // 使用模板配置中的键作为标签\n        return { value: key, label: key };\n    });\n\n    const frameworkType = await select({\n        message: 'Pick a framework type.',\n        options: frameworkOptions,\n    });\n\n    if (isCancel(frameworkType)) {\n        log.info('Operation cancelled.');\n        process.exit(0);\n    }\n\n    // 获取所选框架的模板，使用可选链操作符检查\n    const selectedTemplates = templates?.[frameworkType];\n\n    // 检查所选框架的模板是否存在\n    if (!selectedTemplates) {\n        log.error(`No templates found for framework: ${frameworkType}`);\n        process.exit(1);\n    }\n\n    // 将模板对象转换为选项数组\n    const templateOptions = Object.entries(selectedTemplates).map(([key, value]) => {\n        // 使用模板配置中的键作为标签\n        return {value: key, label: key, hint: value};\n    });\n\n    // 选择具体模板\n    const templateType = await select({\n        message: 'Pick a template.',\n        options: templateOptions,\n    });\n\n    if (isCancel(templateType)) {\n        log.info('Operation cancelled.');\n        process.exit(0);\n    }\n\n    log.step(`Creating new SSR project: ${projectName} with ${frameworkType} ${templateType} template (using ${selectedTemplates[templateType]})`);\n\n    // 根据选择的框架和模板创建项目\n    try {\n        const templatePath = selectedTemplates[templateType];\n\n        // 创建并启动 spinner\n        const loading = spinner();\n        loading.start(`Cloning template from: ${templatePath}`);\n\n        // 使用 @npmcli/git 克隆模板\n        await clone(templatePath, '', join(process.cwd(), projectName));\n\n        // 停止 spinner 并显示成功信息\n        loading.stop(`Successfully cloned template: ${templatePath}`);\n\n        log.success(`Successfully created project: ${projectName}`);\n\n        log.message('Next steps:');\n        log.message(`  cd ${projectName}`);\n        log.message('  npm install (or yarn install / pnpm install)');\n        log.message('  npm run dev');\n    } catch (error) {\n        log.error(`Failed to create project: ${error.message}`);\n        process.exit(1);\n    }\n}","#!/usr/bin/env node\n\nimport {Command} from 'commander';\nimport {log} from '@clack/prompts';\nimport {checkNodeVersion, getPackageVersion} from '../utils/index.mjs';\nimport {createProject} from './create.mjs';\n\nasync function main() {\n    // 检查 Node.js 版本\n    checkNodeVersion();\n\n    const program = new Command();\n\n    // 设置程序版本\n    program\n        .version(getPackageVersion())\n        .name('syn')\n        .description('A CLI tool for creating Server-Side Rendering projects');\n\n    // 定义 create 命令\n    program\n        .command('create')\n        .description('create a new project')\n        .argument('[project-name]', 'name of the project')\n        .action(async (projectName) => {\n            await createProject(projectName);\n        });\n\n    // 解析命令行参数\n    await program.parseAsync();\n}\n\nmain().catch((error) => {\n    log.error(error.message);\n    process.exit(1);\n});"],"names":["checkNodeVersion","requiredVersion","currentNodeVersion","semver","log","__dirname","dirname","fileURLToPath","getPackageVersion","packageJsonPath","join","readFileSync","reactTemplates","vueTemplates","templates","isValidProjectName","name","createProject","projectName","text","value","trimmedValue","isCancel","projectPath","existsSync","overwrite","confirm","rmSync","frameworkOptions","key","frameworkType","select","selectedTemplates","templateOptions","templateType","templatePath","loading","spinner","clone","error","main","program","Command"],"mappings":"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"}